{% extends "base_layout.html" %}

{% block content %}
<div class="admin-container">
    <h2>Saisie Collective des Notes</h2>
    <p>Sélectionnez la matière et la session, puis saisissez les notes pour chaque étudiant.</p>

    <form method="POST">
        <div style="display: flex; gap: 20px; background: #ebf2ff; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #2575fc;">
            <div style="flex: 1;">
                <label>Matière :</label>
                <select name="matiere_id" required>
                    <option value="" disabled selected>-- Choisir une matière --</option>
                    {% for m in matieres %}
                        <option value="{{ m.id }}">{{ m.nom_matiere }} (Prof: {{ m.nom_professeur }})</option>
                    {% endfor %}
                </select>
            </div>
            <div style="flex: 1;">
                <label>Session d'examen :</label>
                <select name="session_type" required>
                    <option value="Contrôle Continu">Contrôle Continu</option>
                    <option value="Session Normale">Session Normale</option>
                    <option value="Rattrapage">Rattrapage</option>
                </select>
            </div>
        </div>

        <table style="width: 100%; border-collapse: collapse;">
            <thead style="background-color: #2c3e50; color: white;">
                <tr>
                    <th style="width: 20%;">Matricule</th>
                    <th style="width: 50%;">Nom & Prénom de l'étudiant</th>
                    <th style="width: 30%;">Note (sur 20)</th>
                </tr>
            </thead>
            <tbody>
                {% for etu in etudiants %}
                <tr>
                    <td><strong>{{ etu.matricule }}</strong></td>
                    <td>{{ etu.nom }}</td>
                    <td>
                        <input type="number" 
                               name="note_{{ etu.id }}" 
                               step="0.01" 
                               min="0" 
                               max="20" 
                               placeholder="Saisir note..." 
                               style="padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; width: 80%;">
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div style="margin-top: 30px; text-align: right;">
            <a href="{{ url_for('admin_dashboard') }}" style="text-decoration: none; color: #7f8c8d; margin-right: 20px;">Annuler</a>
            <button type="submit" style="background-color: #2ecc71; padding: 15px 40px; font-weight: bold; font-size: 1.1em;">
                ✅ Enregistrer toutes les notes
            </button>
        </div>
    </form>
</div>
{% endblock %}